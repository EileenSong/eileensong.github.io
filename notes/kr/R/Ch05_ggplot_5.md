---
layout: article
title: 5. ë‘ ê°œì˜ ë²”ì£¼í˜• ë³€ìˆ˜
permalink: /notes/kr/R/Ch05_ggplot_5
key: notes
sidebar:
  nav: notes-kr
aside:
  toc: true
mermaid: true
mathjax: true
---

<br>

# ë‘ ê°œì˜ ë²”ì£¼í˜• ë³€ìˆ˜


<br>


## Data Intrdoction : 'Titanic' in R


Titanicì€ rì— ë‚´ì¥ëœ í•¨ìˆ˜ì´ë‹¤. íƒ€ì´íƒ€ë‹‰ ë°ì´í„°ëŠ” í•™ìŠµìš©ìœ¼ë¡œ ì›Œë‚™ ìœ ëª…í•˜ë‹ˆ ìƒëµí•˜ê² ë‹¤. ìŠ¹ê°ë“¤ì˜ ìš´ëª…ì— ê´€í•œ ì •ë³´ë¥¼ ë‹´ì•„ë‘” ê²ƒ ì •ë„..


```r
data("Titanic")
Titanic
str(Titanic)
```

str(Titanic)ë¡œ ë³€ìˆ˜ë¥¼ í™•ì¸í•´ì¤€ë‹¤


> str(Titanic)
 'table' num [1:4, 1:2, 1:2, 1:2] 0 0 35 0 0 0 17 0 118 154 ...
 - attr(*, "dimnames")=List of 4
  ..$ Class   : chr [1:4] "1st" "2nd" "3rd" "Crew"
  ..$ Sex     : chr [1:2] "Male" "Female"
  ..$ Age     : chr [1:2] "Child" "Adult"
  ..$ Survived: chr [1:2] "No" "Yes"


4ì°¨ì› í…Œì´ë¸”ì´ë‹¤. 

## apply()

```r
apply(Titanic, 1, sum)
```
Titanic ë°ì´í„°ì˜ 1ë²ˆì§¸ ë³€ìˆ˜(Class)ë¥¼ ëª¨ë‘ sumì„ í•˜ë¼ëŠ” ì˜ë¯¸ì´ë‹¤. ë”°ë¼ì„œ í´ë˜ìŠ¤ë³„ ë¶„í¬ë¥¼ ì•Œ ìˆ˜ ìˆëŠ” ê²ƒì´ë‹¤.


ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

 1st  2nd  3rd Crew 

 325  285  706  885 



```r
apply(Titanic, 2, sum)
```
> apply(Titanic, 2, sum)
  Male Female 
  1731    470 



```r
apply(Titanic, 3, sum)
```
Child Adult 

  109  2092


```r
apply(Titanic, 4, sum)
```

    No  Yes 

1490  711




```r
apply(Titanic, c(1,4), sum)
apply(Titanic, c(2,4), sum)
apply(Titanic, c(3,4), sum)
```


ê° í´ë˜ìŠ¤ë³„ í…Œì´ë¸”ì„ í•©í•œ ì°¨ì›ì„ ë§Œë“¤ì–´ì¤€ë‹¤. 


1ë²ˆê³¼ 4ë²ˆ í…Œì´ë¸”ì„ í•©ì¹œ ê²ƒë§Œ ì‚´ì§ ë³´ìë©´, ë‹¤ìŒ ê²°ê³¼ê°€ ë‚˜ì˜¨ë‹¤.


      Survived

Class   No Yes

  1st  122 203

  2nd  167 118

  3rd  528 178

  Crew 673 212



## geom_mosaic


ggmosaicì„ í™œìš©í•´ë³´ê² ë‹¤. ë‹¹ì—°íˆ, íŒ¨í‚¤ì§€ê°€ ì—†ë‹¤ë©´ ì„¤ì¹˜í•´ì•¼í•œë‹¤.

mosaic() í•¨ìˆ˜ëŠ” ë²”ì£¼í˜• ë³€ìˆ˜ë“¤ ê°„ì˜ ê´€ê³„ë¥¼ ì‹œê°í™”í•˜ê¸° ìœ„í•œ ëª¨ìì´í¬ í”Œë¡¯(mosaic plot)ì„ ìƒì„±í•˜ëŠ” í•¨ìˆ˜ë‹¤. ëª¨ìì´í¬ í”Œë¡¯ì€ í…Œì´ë¸” ë‚´ì˜ ë¹ˆë„ë‚˜ ë¹„ìœ¨ì— ë”°ë¼ ê° ì¹´í…Œê³ ë¦¬ì˜ ì˜ì—­ í¬ê¸°ë¥¼ ì¡°ì ˆí•˜ì—¬, ë‘ ê°œ ì´ìƒì˜ ë²”ì£¼í˜• ë³€ìˆ˜ ê°„ì˜ ê´€ê³„ë¥¼ ì‹œê°ì ìœ¼ë¡œ í‘œí˜„í•  ìˆ˜ ìˆë‹¤.



```r
library(ggmosaic)
as.data.frame(Titanic)
Titanic.data<-as.data.frame(Titanic)
head(Titanic.data)
```

![Alt text](img/ggplot_39.png)



as.data.frame() í•¨ìˆ˜ë¥¼ ì¨ì£¼ì–´ Rì—ì„œ ê°ì²´ë¥¼ ë°ì´í„° í”„ë ˆì„(data frame) í˜•íƒœë¡œ ë³€í™˜í•œë‹¤.


Titanic ë°ì´í„°ì…‹ì€ table í˜•ì‹ì´ê¸° ë•Œë¬¸ì—, data.frame ê°ì²´ë¡œ ë³€í™˜í•œ ê²ƒì´ë‹¤. 


íŠ¹íˆ, as.data.frame() í•¨ìˆ˜ë¥¼ table ê°ì²´ì— ì ìš©í•˜ë©´, ê° ì°¨ì›ì˜ ì¡°í•©ì— ëŒ€í•œ ë¹ˆë„ìˆ˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” í–‰ìœ¼ë¡œ ë°ì´í„° í”„ë ˆì„ì´ ìƒì„±ëœë‹¤. ì´ ë•Œ, "Freq"ë¼ëŠ” ì—´(column)ì´ ìë™ìœ¼ë¡œ ì¶”ê°€ë˜ì–´, í•´ë‹¹ ì¡°í•©ì˜ ë¹ˆë„ìˆ˜ë¥¼ ë‚˜íƒ€ë‚´ë©°, ë§ˆì§€ë§‰ ì¹¼ëŸ¼ìœ¼ë¡œ Freqê°€ ë¶™ê²Œ ëœë‹¤.



### Q1. íƒ‘ìŠ¹ í´ë˜ìŠ¤ì— ë”°ë¼ survivedê°€ ì–´ë–»ê²Œ ë‹¬ë¼ì§€ëŠ”ê°€?


ì´ì œ ì´ íƒ€ì´íƒ€ë‹‰ ë°ì´í„°ë¥¼ ê°€ì§€ê³  ê·¸ë¦¼ì„ ê·¸ë ¤ë³´ê² ë‹¤. ë²”ì£¼í˜• ë°ì´í„°ëŠ” í•˜ë‚˜ì˜ ê¸°ì¤€ìœ¼ë¡œ ì„¸ìš°ê³  ê·¸ë ¤ì•¼ í•œë‹¤.

```r
ggplot(Titanic.data)+geom_mosaic(aes(x=product(Class), weight=Freq, fill=Survived))
```

#### product()

ë³´í†µ xì— Classë¥¼ ì“°ëŠ”ë°, ì—¬ê¸°ì„  productì— ë„£ì–´ì£¼ì—ˆë‹¤. product() í•¨ìˆ˜ëŠ” ì—¬ëŸ¬ ë²”ì£¼í˜• ë³€ìˆ˜ë“¤ì„ ê²°í•©í•˜ì—¬ ëª¨ìì´í¬ í”Œë¡¯ì˜ ì¶•ì„ êµ¬ì„±í•˜ëŠ” ë° í•„ìš”í•˜ë‹¤. ë°ì´í„° ë‚´ì˜ ì—¬ëŸ¬ ë²”ì£¼í˜• ë³€ìˆ˜ë“¤ì„ ê³±í•˜ì—¬ í•˜ë‚˜ì˜ ë²”ì£¼í˜• ë³€ìˆ˜ë¡œ ê²°í•©(combine)í•˜ê³ , ê·¸ ë³€ìˆ˜ëŠ” ëª¨ìì´í¬ í”Œë¡¯ì˜ í•˜ë‚˜ì˜ ì¶•ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ëœë‹¤.


ê·¸ë¦¬ê³ , ê° ì¡°í•©ì˜ ë¹ˆë„(Freq)ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ìì´í¬ í”Œë¡¯ì˜ ê° ì˜ì—­ì˜ í¬ê¸°ë¥¼ ê²°ì •í•˜ì˜€ë‹¤.


![Titanic](img/ggplot_40.png)

ìœ„ ê·¸ë¦¼ ì²˜ëŸ¼ Titanic ë°ì´í„°ì—ì„œ Classì™€ Sex ë³€ìˆ˜ë¥¼ ëª¨ìì´í¬ í”Œë¡¯ì˜ xì¶•ì— ë™ì‹œì— í‘œí˜„í•˜ê³  ì‹¶ê¸° ë•Œë¬¸ì—, x=product(Class, Sex)ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©í•œ ê²ƒì´ë‹¤. ì´ë ‡ê²Œ í•˜ë©´, xì¶•ì€ Classì™€ Sexì˜ ëª¨ë“  ì¡°í•©ì„ í¬í•¨í•˜ê²Œ ëœë‹¤.

product() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ë‹¨ì¼ ë³€ìˆ˜ë§Œì„ ì§€ì •í•˜ë©´, ëª¨ìì´í¬ í”Œë¡¯ì€ í•´ë‹¹ ë³€ìˆ˜ì— ë”°ë¼ë§Œ ë¶„í• ëœë‹¤. ì–´ì¨Œë“ .. ì—¬ëŸ¬ ë³€ìˆ˜ë¥¼ ë™ì‹œì— ê³ ë ¤í•˜ì—¬ í”Œë¡¯ì„ ìƒì„±í•˜ê¸° ìœ„í•´ì„œ product() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ ë³€ìˆ˜ë“¤ì„ ê²°í•©í•œ ê²ƒì´ë‹¤.


**ì „ì²´ë¥¼ 100ìœ¼ë¡œ ë´¤ì„ ë•Œ x ì¶•ì˜ ë„“ì´ëŠ” 1st, 2nd..ë“± classë¥¼ ê¸°ì¤€ìœ¼ë¡œ í¬ì…˜ì´ ë‚˜ëˆ„ì–´ ì§„ ê²ƒì´ë‹¤**


Classê°€ 1ì¼ë•Œ, 2ì¼ë•Œ,.. survivedì˜ ë¶„í¬ì¸ë°,



! ì¡°ê±´ì„ ë°˜ëŒ€ë¡œ í•´ë³´ê² ë‹¤


```r
ggplot(Titanic.data)+geom_mosaic(aes(x=product(Survived), weight=Freq, fill=Class))
```

![Titanic](img/ggplot_41.png)


xì¶•ì€ ì „ì²´ yesì™€ noì˜ ë¹„ìœ¨ì„ ë³¼ ìˆ˜ ìˆëŠ”ë° ë” ë§ì´ ìƒì¡´ì„ ëª»í•œ ê²ƒì„ ì•Œ ìˆ˜ ìˆê³  ê·¸ ì•ˆì—ì„œì˜ í´ë˜ìŠ¤ë³„ ë¹„ìœ¨ì„ ì•Œ ìˆ˜ ìˆë‹¤. 


<br>

### Q2. ì„±ë³„ì— ë”°ë¼ survivedê°€ ì–´ë–»ê²Œ ë‹¬ë¼ì§€ëŠ”ê°€?


```r
ggplot(Titanic.data)+geom_mosaic(aes(x=product(Sex), weight=Freq, fill=Survived))
```
![Titanic](img/ggplot_42.png)

ì„±ë³„ì´ ì£¼ì–´ì¡Œì„ ë•Œì˜ ìƒì¡´ ë¹„ìœ¨.. ë‚¨ìëŠ” ë°˜ ì´ìƒ ì‚´ì•„ë‚¨ì•˜êµ¬ë‚˜..



ì´ê²ƒ ë˜í•œ Q1ì²˜ëŸ¼ ë°˜ëŒ€ ì¡°ê±´ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ë„ ìˆë‹¤.

```r
ggplot(Titanic.data)+geom_mosaic(aes(x=product(Survived), weight=Freq, fill=Sex))
```


<br>

### Q3. ë‚˜ì´(ì„±ì¸/ì•„ì´)ì— ë”°ë¼ survivedê°€ ì–´ë–»ê²Œ ë‹¬ë¼ì§€ëŠ”ê°€?

```r
ggplot(Titanic.data)+geom_mosaic(aes(x=product(Age), weight=Freq, fill=Survived))
```
![Titanic](img/ggplot_43.png)


ë‚˜ì´ë³„ë¡œë„ ì‚´í´ë³¼ ìˆ˜ ìˆë‹¤..


ë‹¹ì—°íˆ ì¡°ê±´ì„ ë‚˜ëˆ„ì–´ ë‹¤ë¥´ê²Œ ì‚´í´ë³¼ ìˆ˜ë„ ìˆë‹¤.


```r
ggplot(Titanic.data)+geom_mosaic(aes(x=product(Survived), weight=Freq, fill=Age))
```

<br>


## ì •ë¦¬í•˜ìë©´


categorical, ë²”ì£¼í˜•ì¼ ë–„ íŠ¹íˆ **variableì´ 2ê°œ** ì¼ ë•ŒëŠ” ë‘ ë°©í–¥ìœ¼ë¡œ ì¡°ê±´ì„ ë‚˜ëˆ„ì–´ ë³¼ ìˆ˜ ìˆê³ , ê·¸ ë•Œë§ˆë‹¤ ë³´ì—¬ì£¼ëŠ” ì •ë³´ëŠ” ë‹¤ë¥´ê¸° ë•Œë¬¸ì—, ì ì ˆí•˜ê²Œ ì‚¬ìš©í•  í•„ìš”ê°€ ìˆêµ¬ë‚˜!




<br><br><br>
ëğŸ™‚
<br><br><br>